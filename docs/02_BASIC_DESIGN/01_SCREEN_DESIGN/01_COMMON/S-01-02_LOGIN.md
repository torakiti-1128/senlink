# S-01-02 ログイン

## 1. 概要
- 対象ロール：ALL
- 目的：メール／パスワード または OTP により認証し、SenLinkを利用可能にする。
- 遷移元：
  - 未ログインでログイン後画面にアクセスした場合
  - ログアウト後
  - パスワード再設定完了後
- 遷移先：
  - 初回設定が未完了の場合：S-01-06（初回設定）
  - 初回設定完了済の場合：各ロールのホームへ
    - Student → S-02-01
    - Teacher → S-03-01
    - Admin → S-04-01
  - 新規登録：S-01-03
  - パスワード再設定：S-01-05

## 2. 画面構成
- メイン領域：
  - ログインフォーム
  - ログイン方式切替（メール／パスワード／OTP）
  - 新規登録／パスワード再設定リンク
- フッター：あり
※ ヘッダーは非表示

## 3. 表示項目
- 入力項目
  - メールアドレス
  - パスワード（メール/パスワード方式の場合）
  - OTP（別画面遷移）
- リンク
  - 新規登録（S-01-03）
  - パスワード再設定（S-01-05）
- エラーメッセージ（概要レベル）
  - 認証失敗（メール／パスワード不一致 等）
  - OTP不一致／期限切れ
  - 学外アクセス（学内IP制限）：S-01-01へ

## 4. 操作
- ログイン実行
  - メール／パスワードでログイン
  - OTPでログイン（OTP送信→入力→認証）
- ログイン方式切替（メール／パスワード ⇄ OTP）
- 新規登録へ遷移（S-01-03）
- パスワード再設定へ遷移（S-01-05）

## 5. 関連API
- ログイン（メール／パスワード）
  - POST /api/v1/auth/login
- OTP送信（ログイン用）
  - POST /api/v1/auth/otp/send
- OTP検証（ログイン用）
  - POST /api/v1/auth/otp/verify
- ログイン後の状態取得（初回設定判定・ロール判定）
  - GET /api/v1/auth/me
  - （または）GET /api/v1/auth/session

## 6. 補足
- 認証成功時はCookie(HttpOnly)+JWTが設定される。
- 初回設定未完了の判定は、ログイン直後にユーザー状態を参照して分岐する。

# S-01-04 OTP認証

## 1. 概要
- 対象ロール：ALL
- 目的：OTPを入力して認証を完了する（ログイン／新規登録／パスワード再設定で共通利用）。
- 遷移元：
  - S-01-02（ログイン：OTP方式）
  - S-01-03（新規登録）
  - S-01-05（パスワード再設定：OTP送信後）
- 遷移先（用途により分岐）：
  - ログイン用途：
    - 初回設定が未完了：S-01-06（初回設定）
    - 初回設定完了済：各ロールのホーム（S-02-01／S-03-01／S-04-01）
  - 新規登録用途：
    - 登録確定（必要なら）→ S-01-06（初回設定）
  - パスワード再設定用途：
    - パスワード再設定入力（S-01-05内の次ステップ または 別画面）へ

## 2. 画面構成
- メイン領域：
  - OTP入力フォーム
  - 再送ボタン（任意：クールタイムあり）
  - 戻る導線（任意）
- フッター：あり
※ヘッダーは非表示（または、ロゴのみ）

## 3. 表示項目
- 入力項目
  - OTP（桁数はシステム設定に従う）
- 表示文言（例）
  - 送信先メールアドレスの一部マスク表示（任意）
  - OTPの有効期限の注意（任意）
- エラーメッセージ（概要レベルで可）
  - OTP不一致
  - OTP期限切れ
  - 試行回数超過（必要なら）
  - 学外アクセス（学内IP制限）：S-01-01へ

## 4. 操作
- OTP認証実行
  - 入力したOTPを送信して検証する
  - 成功時：用途に応じた遷移先へ
- OTP再送（任意）
  - OTPを再送する（クールタイムを設ける想定）
- 戻る（任意）
  - 遷移元（ログイン／新規登録／再設定）へ戻る

## 5. 関連API
- ログインOTP
  - POST /api/v1/auth/login/otp/verify
- 新規登録OTP
  - POST /api/v1/auth/register/otp/verify
- パスワード再設定OTP
  - POST /api/v1/auth/password/reset/otp/verify

## 6. 補足
- 本画面は「OTP入力と検証」を共通化する目的で利用する。
- 画面側で用途（ログイン／新規登録／再設定）を保持し、成功時の遷移先を切り替える想定。
- OTP桁数／有効期限／再送制限（クールタイム等）はシステム設定（Maintenance）に従う想定。
